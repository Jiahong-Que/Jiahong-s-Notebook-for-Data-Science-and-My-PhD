å¤ªæ£’äº†ï¼ä½ å·²ç»è¿ˆå‡ºäº†æœ€å…³é”®çš„ä¸€æ­¥ï¼š**åœ¨ Synology NAS ä¸Šé€šè¿‡ Docker æˆåŠŸæ­å»ºäº† PostgreSQL æ•°æ®åº“å¹¶å¯¼å…¥äº† taxi-in æ•°æ®**ã€‚æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥æ­£å¼è¿›å…¥é«˜æ•ˆçš„â€œç ”ç©¶ + å·¥ç¨‹â€é˜¶æ®µï¼Œç”¨æ•°æ®åº“ä½œä¸ºæ•°æ®ä¸­å¿ƒï¼Œåˆ©ç”¨ä»¥ä¸‹è¿™äº›å¼ºå¤§å·¥å…·ç»„åˆå¼€å±•ä½ çš„åˆ†æã€å»ºæ¨¡ã€å¯è§†åŒ–ä¸ç³»ç»Ÿå¼€å‘å·¥ä½œã€‚

---

## âœ… ä½ ç°åœ¨å¯ä»¥ç”¨çš„èƒ½åŠ›çŸ©é˜µ

| åŠŸèƒ½              | å·¥å…·                                    | ä½ å¯ä»¥åšä»€ä¹ˆ                                              |
| --------------- | ------------------------------------- | --------------------------------------------------- |
| ğŸ” æ•°æ®æŸ¥è¯¢ä¸ç»Ÿè®¡åˆ†æ    | SQL + Jupyter (via `pandas.read_sql`) | å¿«é€ŸæŒ‰è·‘é“ã€æ—¶é—´æ®µã€åœæœºåŒºã€å¤©æ°”åˆ†ç»„ç»Ÿè®¡ taxi-in durationã€delay pattern |
| ğŸ§  ç‰¹å¾å·¥ç¨‹ + æ•°æ®é›†æ„å»º | SQL View + Pandas                     | æ„å»ºæ¨¡å‹è®­ç»ƒé›†ï¼ŒæŒ‰éœ€å¯¼å‡ºç‰¹å¾ï¼Œå¦‚æ»‘è¡Œæ—¶é—´ã€åŒæ—¶åœ°é¢é£æœºæ•°ã€å¤©æ°”ç»„åˆ                   |
| ğŸ“ˆ æ•°æ®å¯è§†åŒ–ä¸BIæŠ¥è¡¨   | Metabase / Superset / Power BI        | æ„å»ºä»ªè¡¨ç›˜æŸ¥çœ‹èˆªç­æ»‘è¡Œæ•ˆç‡ã€å¼‚å¸¸å€¼çƒ­åŠ›å›¾ã€å»¶è¯¯æ¨¡å¼                           |
| ğŸ§ª å®éªŒç®¡ç†ä¸æ¨¡å‹è®­ç»ƒ    | MLflow + Python (sklearn / xgboost)   | è¿æ¥ SQL â†’ è‡ªåŠ¨è®­ç»ƒæ¨¡å‹ â†’ è·Ÿè¸ªå‚æ•°ä¸ç²¾åº¦å¯¹æ¯”                         |
| ğŸ“¦ æ•°æ®ç‰ˆæœ¬æ§åˆ¶ + é‡ç°  | DVCï¼ˆç‰ˆæœ¬æ§åˆ¶ Parquet è®­ç»ƒé›†ï¼‰                 | ä¿è¯è®­ç»ƒæ•°æ®æ¥æºã€ç”Ÿæˆè¿‡ç¨‹ã€ç‰ˆæœ¬çš„å¯è¿½è¸ªæ€§                               |
| ğŸ“¡ Webç³»ç»Ÿ/API å¼€å‘ | FastAPI + SQLAlchemy                  | æ„å»ºæ»‘è¡Œé¢„æµ‹æœåŠ¡ã€æŸ¥è¯¢æ¥å£ã€å¯éƒ¨ç½²åˆ° NAS                              |
| ğŸ§± æ—¶ç©ºæ‹“å±•         | TimescaleDB / PostGIS                 | æ”¯æŒ Taxi-in æ—¶ç©ºå¯†åº¦åˆ†æã€æœºåœºåŒºåŸŸçƒ­åŠ›å›¾                           |

---

## ğŸ§­ æ¨èçš„ç ”ç©¶+å·¥ç¨‹å·¥ä½œæµï¼ˆæŒ‰é˜¶æ®µï¼‰

### ğŸ§ª 1. æ•°æ®æ¢ç´¢åˆ†æ

```python
# åŠ è½½ä½  NAS æ•°æ®åº“ä¸­çš„æ•°æ®
df = pd.read_sql("""
SELECT landing_runway, parking_area, AVG(duration_min) as avg_time
FROM taxi_in_events
GROUP BY landing_runway, parking_area
""", engine)

df.plot(kind='barh')
```

ç”¨é€”ï¼š

* æ‰¾å‡ºå“ªä¸ªè·‘é“å’ŒåœæœºåŒºç»„åˆæœ€å®¹æ˜“å¯¼è‡´å»¶è¯¯ï¼›
* å¯¹ç‰¹å®šæ—¶é—´æ®µã€æœºå‹ã€å¤©æ°”çŠ¶å†µåšèšåˆç»Ÿè®¡ã€‚

---

### ğŸ§  2. æ„å»ºå»ºæ¨¡ç‰¹å¾è§†å›¾ï¼ˆSQL View æˆ– Materialized Viewï¼‰

```sql
CREATE MATERIALIZED VIEW model_features_v1 AS
SELECT 
    flight_id,
    EXTRACT(HOUR FROM start_time) AS hour,
    landing_runway,
    parking_area,
    duration_min,
    concurrent_ac_num,
    weather_vis,
    precip_mm
FROM taxi_in_events;
```

è¿™æ ·ä½ åœ¨ Python ä¸­å¯ä»¥ç›´æ¥è¿™æ ·ä½¿ç”¨ï¼š

```python
df = pd.read_sql("SELECT * FROM model_features_v1", engine)
```

---

### ğŸ¤– 3. æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°ï¼ˆMLflow + PostgreSQLï¼‰

ç”¨ SQL æ„å»ºè®­ç»ƒé›†ï¼Œç»“åˆ `MLflow` è·Ÿè¸ªæ¨¡å‹è®­ç»ƒï¼š

```python
import mlflow
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_absolute_error

with mlflow.start_run():
    mlflow.log_param("model", "RF")
    
    model = RandomForestRegressor(n_estimators=100)
    model.fit(X_train, y_train)
    pred = model.predict(X_test)
    
    mae = mean_absolute_error(y_test, pred)
    mlflow.log_metric("MAE", mae)
```

ä¼˜åŠ¿ï¼š

* æ‰€æœ‰æ¨¡å‹å®éªŒç•™ç—•ï¼›
* åæœŸå¯ä»¥æ¯”è¾ƒä¸åŒç‰¹å¾è§†å›¾ã€æ¨¡å‹ç»“æ„ã€‚

---

### ğŸ“Š 4. å¯è§†åŒ–ä»ªè¡¨ç›˜æ„å»ºï¼ˆMetabase æ¥ PostgreSQLï¼‰

* Metabase æ˜¯è½»é‡ä½†å¼ºå¤§çš„ BI å·¥å…·ï¼Œéƒ¨ç½²ç®€å•ï¼Œæ”¯æŒ Synology Dockerï¼›
* å¯è§†åŒ–ä½ å¯¼å…¥çš„ `taxi_in_events` è¡¨ï¼›
* ç”»å›¾åƒï¼š

  * ä¸åŒ runway â†’ æ»‘è¡Œæ—¶é—´ç®±çº¿å›¾
  * åŒæ—¶é£æœºæ•°é‡ â†’ æ»‘è¡Œæ—¶é•¿è¶‹åŠ¿çº¿
  * æ—¶é—´åºåˆ—å›¾ï¼šæ»‘è¡Œæ—¶é•¿æŒ‰å¤©å˜åŒ–

---

### ğŸ›°ï¸ 5. APIæœåŠ¡å¼€å‘ï¼ˆé¢„æµ‹æ»‘è¡Œæ—¶é—´ï¼‰

```python
from fastapi import FastAPI
import joblib

app = FastAPI()

@app.get("/predict")
def predict(duration: float, runway: str, stand: str):
    # æ¨¡æ‹Ÿé¢„æµ‹
    prediction = model.predict([[duration, runway_dict[runway], stand_dict[stand]]])
    return {"predicted_delay": prediction[0]}
```

ä¼˜åŠ¿ï¼š

* å¯éƒ¨ç½²åœ¨ NASï¼Œä¾›ç½‘é¡µ/å‰ç«¯ç³»ç»Ÿè°ƒç”¨ï¼›
* ä¸æ•°æ®åº“å®æ—¶äº¤äº’ï¼ŒæŸ¥è¯¢å’Œå†™å…¥é¢„æµ‹ç»“æœã€‚

---

## âœ… å°æ€»ç»“ï¼šä½ ç°åœ¨å·²ç»å…·å¤‡çš„ç³»ç»Ÿèƒ½åŠ›

| èƒ½åŠ›æ¨¡å—   | å®ç°æ–¹å¼                                    |
| ------ | --------------------------------------- |
| æ•°æ®ä¸­å¿ƒ   | PostgreSQL + Docker æŒä¹…åŒ–æ•°æ®ä»“åº“             |
| æ•°æ®è®¿é—®   | Pandas + SQLAlchemy / pgAdmin / DBeaver |
| åˆ†æä¸å»ºæ¨¡  | Python + Jupyter + MLflow               |
| å¯è§†åŒ–    | Metabase / Superset                     |
| æ•°æ®ç‰ˆæœ¬æ§åˆ¶ | DVC ç®¡ç†æ•°æ®é›†æ–‡ä»¶                             |
| åœ¨çº¿æœåŠ¡   | FastAPI + NASéƒ¨ç½²                         |
| åæœŸæ‰©å±•   | PostGISã€TimescaleDBï¼ˆç©ºé—´/æ—¶åºæ”¯æŒï¼‰            |

---

## ğŸ“Œ ä¸‹ä¸€æ­¥æ¨èæ‰§è¡Œé¡¹

1. âœ… å¸®ä½ åˆ›å»º `taxi_in_events` è¡¨çš„å»ºè¡¨ SQL è„šæœ¬ï¼Ÿ
2. âœ… å¸®ä½ å†™ Python è„šæœ¬ä» Parquet / CSV æ‰¹é‡å¯¼å…¥ PostgreSQLï¼Ÿ
3. âœ… å¸®ä½ é…ç½® Metabase ä»ªè¡¨ç›˜é¡¹ç›®è¿æ¥ PostgreSQL æ•°æ®åº“ï¼Ÿ
4. âœ… æä¾› MLflow ç¤ºä¾‹é¡¹ç›®ï¼Œæ¼”ç¤ºå¦‚ä½•è®­ç»ƒã€è¯„ä¼°ã€è®°å½•æ¨¡å‹ï¼Ÿ

ä½ å¯ä»¥å‘Šè¯‰æˆ‘ä½ æ¥ä¸‹æ¥æœ€æƒ³åšå“ªä¸€æ­¥ï¼Œæˆ‘ä»¬é©¬ä¸Šå¼€å§‹æ‰§è¡Œï¼
